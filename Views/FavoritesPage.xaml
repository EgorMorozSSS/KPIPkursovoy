<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Course.Views.FavoritesPage"
             xmlns:viewmodel="clr-namespace:Course.ViewModels"
             xmlns:models="clr-namespace:Course.Models"
             xmlns:controls="clr-namespace:Course.CustomControls"
             x:DataType="viewmodel:FavoritesViewModel"
             Title="Favorite Books"
             BackgroundColor="{AppThemeBinding Light={StaticResource Gray100}, Dark={StaticResource OffBlack}}">

    <ScrollView>
        <VerticalStackLayout Padding="15" Spacing="15">
            <Label Text="Favorite Books" 
                   Style="{StaticResource Headline}" 
                   HorizontalOptions="Center"/>

            <CollectionView ItemsSource="{Binding FavoriteBooks}"
                            EmptyView="No favorite books yet">
                <CollectionView.ItemsLayout>
                    <GridItemsLayout Orientation="Vertical" 
                                     Span="2" 
                                     VerticalItemSpacing="10"
                                     HorizontalItemSpacing="10"/>
                </CollectionView.ItemsLayout>
                <CollectionView.ItemTemplate>
                    <DataTemplate x:DataType="models:Book">
                        <Border Style="{StaticResource CardStyle}">
                            <Grid RowDefinitions="Auto,Auto,Auto,Auto" 
      ColumnDefinitions="Auto,*"
      RowSpacing="5">

                                <controls:CustomImageControl Base64Source="{Binding Image}" 
                                 WidthRequest="80" 
                                 HeightRequest="120"
                                 HorizontalOptions="Center" />

                                <Label Text="{Binding Title}" 
           FontAttributes="Bold"
           Style="{StaticResource FieldLabel}"
           Grid.Column="1"
           Grid.Row="0"/>

                                <Label Text="{Binding Description}" 
           FontAttributes="None"
           Style="{StaticResource FieldLabel}"
           Grid.Column="1"
           Grid.Row="1"
           LineBreakMode="TailTruncation"
           MaxLines="2" />

                                <Label Text="{Binding Genre}" 
           FontAttributes="Italic"
           Style="{StaticResource CaptionLabel}"
           Grid.Column="1"
           Grid.Row="2"/>

                                <Button Text="Подробнее"
            Command="{Binding Source={RelativeSource AncestorType={x:Type viewmodel:FavoritesViewModel}}, Path=NavigateToDetailsCommand}"
            CommandParameter="{Binding .}"
            Grid.Column="1"
            Grid.Row="3"
            HorizontalOptions="End"
            Padding="5,2"/>
                            </Grid>

                        </Border>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
        </VerticalStackLayout>
    </ScrollView>
</ContentPage>